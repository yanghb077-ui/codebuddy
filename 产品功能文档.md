# 健身记录App - 产品功能文档

**版本**: v1.0.0  
**开发日期**: 2026-01-27  
**产品定位**: 个人健身训练记录与管理工具

---

## 一、产品概述

健身记录App是一款专为健身爱好者设计的训练记录工具，帮助用户系统化记录和管理健身训练数据。采用前后端分离架构，支持训练计划制定、实时训练记录、历史数据查询与分析等功能。

**核心特点**:
- ✅ 简洁易用的训练记录流程
- ✅ 实时训练计时与组数管理
- ✅ 30天训练历史可视化
- ✅ 内置专业动作库（24个动作）
- ✅ 自动计算训练强度
- ✅ 数据持久化存储
- ✅ 响应式设计，支持多端访问
- ✅ 多用户隔离，数据独立存储

---

## 二、功能模块总览

```
┌─────────────────────────────────────────────────────────┐
│                    健身记录App v1.0.0                   │
└─────────────────────────────────────────────────────────┘
                               │
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
┌───────▼───────┐      ┌─────▼──────┐      ┌──────▼──────┐
│   首页模块    │      │  训练模块  │      │  日历模块   │
│               │      │            │      │             │
│ • 7天训练概览 │      │ • 实时计时 │      │ • 30天日历 │
│ • 快速开练    │      │ • 动作选择 │      │ • 训练详情 │
│ • 训练状态    │      │ • 组数记录 │      │             │
└───────────────┘      └────────────┘      └─────────────┘
        │                      │                      │
        └──────────────────────┼──────────────────────┘
                               │
        ┌──────────────────────┼──────────────────────┐
        │                      │                      │
┌───────▼───────┐      ┌─────▼──────┐      ┌──────▼──────┐
│  用户认证模块 │      │  数据管理层 │      │  用户数据   │
│               │      │            │      │             │
│ • 用户名输入  │      │ • MongoDB  │      │ • 数据隔离  │
│ • 用户切换    │      │ • REST API │      │ • 独立存储  │
│ • 最近用户    │      │ • 动作库   │      │ • 隐私保护  │
└───────────────┘      └────────────┘      └─────────────┘
```

---

## 三、核心功能详解

### 📊 模块一：首页仪表盘

**功能定位**: 训练数据总览与快速入口

#### 1.1 最近7天训练日历
**显示内容**:
- 📅 每日训练日期（月/日格式）
- 💪 训练强度标识（低/中/高强度，不同颜色）
- 🏷️ 训练部位标签（胸、背、肩、腿、手臂、核心、全身）
- ✅ 训练状态（已完成/进行中）

**交互功能**:
- 点击任意日期 → 跳转到日历详情页
- 悬停效果 → 轻微上浮动画
- 响应式布局 → 自动适应不同屏幕尺寸

**技术实现**:
- API: `GET /api/workouts/recent-7-days-brief`
- 自动加载，无需手动刷新

#### 1.2 快速开练入口
**主要功能**:
- **🆕 新建训练**: 一键创建新的训练记录
- **▶️ 继续训练**: 智能检测未完成的训练，提供继续选项

**智能提示**:
- 检测当天是否有未完成的训练
- 显示训练创建时间
- 提供"继续训练"和"新建训练"双选项

**技术实现**:
- API: `POST /api/workouts` (新建)
- API: `GET /api/workouts/date/:date` (检测)

---

### 💪 模块二：训练记录

**功能定位**: 实时训练过程记录与管理

#### 2.1 训练计时器
**功能特点**:
- ⏱️ **实时计时**: 从训练开始自动计时，精确到秒
- 📊 **时长显示**: 格式为 `MM:SS`（分钟:秒）
- 🔄 **持续运行**: 后台持续计时，切换页面不影响
- 💾 **自动记录**: 完成训练时自动计算总时长

**视觉效果**:
- 大号字体显示，突出重要性
- 蓝色主题，清晰易读
- 等宽字体，数字对齐

**技术实现**:
- React useState + setInterval 实现
- useEffect 清理定时器
- 完成时计算 duration = (endTime - startTime) / 60000

#### 2.2 动作选择与添加
**功能流程**:
1. **选择动作**: 下拉菜单显示所有可用动作
2. **添加动作**: 点击"添加动作"按钮
3. **显示列表**: 动作添加到训练列表
4. **重复操作**: 可添加多个不同动作

**动作库内容**:
- **胸部**: 卧推、上斜卧推、哑铃飞鸟、俯卧撑
- **背部**: 引体向上、划船、高位下拉、硬拉
- **肩部**: 推举、侧平举、前平举、反向飞鸟
- **腿部**: 深蹲、腿举、腿弯举、小腿提踵
- **手臂**: 弯举、臂屈伸、锤式弯举、绳索下压
- **核心**: 卷腹、平板支撑、俄罗斯转体、悬垂举腿

**动作信息**:
- 动作名称
- 训练部位（胸、背、肩、腿、手臂、核心、全身）
- 难度等级（初级、中级、高级）

**技术实现**:
- API: `GET /api/exercises` (获取动作列表)
- API: `POST /api/workouts/:id/exercises` (添加动作)

#### 2.3 组数记录与管理
**核心功能**:
- **添加组数**: 为每个动作记录重量、次数
- **重量输入**: 数字输入，支持小数（如12.5kg）
- **次数输入**: 整数输入，范围1-999
- **完成标记**: 每组完成后点击"完成"按钮
- **状态显示**: 已完成组数显示绿色背景和✓标记

**操作流程**:
1. 选择动作并添加
2. 输入重量和次数
3. 点击"添加组数"
4. 完成该组后点击"完成"
5. 重复添加更多组数

**数据记录**:
- 组数编号（自动递增）
- 重量（kg）
- 次数（reps）
- 完成状态（boolean）
- 完成时间（timestamp）

**技术实现**:
- API: `POST /api/workouts/:id/sets` (添加组数)
- API: `POST /api/workouts/:id/complete-set` (完成组数)

#### 2.4 完成训练
**功能特点**:
- **一键完成**: 点击"完成训练"按钮
- **二次确认**: 弹出确认对话框
- **自动计算**: 系统计算训练强度和时长
- **状态更新**: 训练状态从"进行中"改为"已完成"

**强度计算算法**:
```javascript
强度 = (完成率 × 0.6 + 重量因子 × 0.4) × 10

其中:
- 完成率 = 已完成组数 / 总组数
- 重量因子 = min(总重量 / 1000, 1)
- 结果范围: 0-10（保留1位小数）
```

**强度等级**:
- 0-3分: 低强度（绿色）
- 4-6分: 中强度（黄色）
- 7-10分: 高强度（红色）

**技术实现**:
- API: `POST /api/workouts/:id/complete`
- 自动计算 intensity 和 duration

---

### 👤 模块四：用户认证与隔离

**功能定位**: 多用户数据隔离与身份识别

#### 4.1 用户登录
**主要功能**:
- **🔐 用户名输入**: 输入不重复的用户名进行身份识别
- **💾 本地存储**: 用户名保存在浏览器 localStorage 中
- **🔄 用户切换**: 支持快速切换不同用户账号
- **📋 最近用户**: 显示最近使用的5个用户名，快速选择

**输入验证**:
- 用户名不能为空
- 至少2个字符，最多20个字符
- 只允许字母、数字、中文和下划线
- 用户名区分大小写

**技术实现**:
- 组件: `frontend/src/components/UserLogin.jsx`
- 存储: `localStorage.getItem('fitness_username')`
- 自动携带: Axios请求拦截器自动附加username参数

#### 4.2 数据隔离
**隔离机制**:
- 每个训练记录绑定到特定用户名
- 用户只能查看和编辑自己的训练数据
- 数据库层按username字段过滤查询

**数据安全**:
- 不同用户数据完全隔离
- 未设置用户名的历史数据不可见
- 局域网多设备访问时数据独立

**技术实现**:
- 模型: `backend/models/Workout.js` 添加 username 字段
- 索引: 复合索引 `{ username: 1, date: -1 }`
- API: 所有查询接口增加 username 参数验证

---

### 📅 模块三：训练日历

**功能定位**: 历史训练数据查询与可视化

#### 3.1 30天训练日历
**视图布局**:
- 7列网格布局（对应周日到周六）
- 30天数据（包含当天）
- 月份标识和星期标识
- 今天高亮显示（黄色背景）

**数据显示**:
- 日期数字
- 训练强度标识（低/中/高）
- 训练部位标签（最多显示2个）

**交互功能**:
- 点击任意日期 → 查看该日训练详情
- 悬停效果 → 轻微阴影变化
- 选中效果 → 蓝色边框高亮

**技术实现**:
- API: `GET /api/workouts/recent?days=30`
- JavaScript Date对象处理日期逻辑

#### 3.2 训练详情查看
**详情内容**:
- 训练日期（完整格式）
- 训练强度评分（0-10分）
- 训练状态（已完成/进行中）
- 训练时长（分钟）
- 所有动作列表
- 每组的重量、次数、完成状态

**显示格式**:
```
2026年1月27日 训练详情
━━━━━━━━━━━━━━━━━━━━━━━━━━━━
训练强度: 8.5/10 (高强度)
训练时长: 68分钟
训练状态: ✅ 已完成

训练动作:
┌─────────────────────────┐
│ 卧推 (胸 - 中级)        │
├─────────────────────────┤
│ 第1组: 60kg × 12 ✓     │
│ 第2组: 60kg × 12 ✓     │
│ 第3组: 65kg × 10 ✓     │
└─────────────────────────┘

┌─────────────────────────┐
│ 深蹲 (腿 - 中级)        │
├─────────────────────────┤
│ 第1组: 80kg × 15 ✓     │
│ 第2组: 80kg × 15 ✓     │
│ 第3组: 80kg × 12 ✓     │
└─────────────────────────┘
```

**技术实现**:
- API: `GET /api/workouts/date/:date`
- 条件渲染：无数据时显示"暂无训练记录"

---

## 四、后端管理功能

### 🔧 数据管理模块

#### 4.1 动作库管理
**内置动作**: 24个专业健身动作

**动作结构**:
```javascript
{
  name: "卧推",              // 动作名称
  bodyPart: "胸",            // 训练部位
  difficulty: "中级",        // 难度等级
  description: "经典胸部训练", // 动作描述
  isDefault: true            // 是否系统默认
}
```

**API接口**:
- `GET /api/exercises` - 获取所有动作
- `POST /api/exercises` - 创建新动作
- `PUT /api/exercises/:id` - 更新动作
- `DELETE /api/exercises/:id` - 删除动作
- `POST /api/exercises/initialize` - 初始化默认动作

#### 4.2 训练记录管理
**数据结构**:
```javascript
{
  username: "zhangsan",      // 用户名（数据隔离标识）
  date: "2026-01-27",        // 训练日期
  startTime: "19:30:00",     // 开始时间
  endTime: "20:38:00",       // 结束时间
  duration: 68,              // 训练时长（分钟）
  exercises: [               // 动作列表
    {
      exercise: { ... },     // 动作信息
      sets: [                // 组数记录
        {
          setNumber: 1,
          weight: 60,
          reps: 12,
          completed: true,
          completedAt: "19:35:00"
        }
      ]
    }
  ],
  intensity: 8.5,            // 训练强度（0-10）
  status: "已完成"           // 训练状态
}
```

**数据库索引**:
```javascript
// 复合索引：支持按用户和时间的高效查询
workoutSchema.index({ username: 1, date: -1 });
workoutSchema.index({ username: 1, status: 1 });
```

**API接口**:
- `GET /api/workouts?username=` - 获取用户所有训练
- `POST /api/workouts` - 创建训练（需username字段）
- `PUT /api/workouts/:id` - 更新训练
- `DELETE /api/workouts/:id` - 删除训练
- `POST /api/workouts/:id/complete` - 完成训练

**用户隔离说明**:
所有训练记录相关API都需要 `username` 参数：
- GET请求通过 query 参数传递: `?username=zhangsan`
- POST/PUT请求通过 body 传递: `{ username: "zhangsan", ... }`
- 服务端验证：缺少username返回400错误

---

## 五、技术特色

### 💎 架构设计亮点

#### 5.1 前端技术栈
- **React 18**: 函数组件 + Hooks（useState, useEffect, useParams）
- **React Router v6**: 声明式路由管理
- **Vite**: 极速开发服务器，热更新
- **Styled Components**: CSS-in-JS，组件化样式
- **Axios**: 异步HTTP请求，拦截器统一处理

#### 5.2 后端技术栈
- **Node.js + Express**: 轻量级Web框架
- **MongoDB + Mongoose**: 文档型数据库，灵活Schema
- **MVC架构**: 模型-视图-控制器分离
- **Service层**: 业务逻辑与数据访问分离
- **RESTful API**: 统一的接口规范

#### 5.3 代码质量
- **JSDoc注释**: 所有函数都有详细注释
- **错误处理**: 统一的错误捕获和日志记录
- **输入验证**: Mongoose Schema验证
- **API文档**: 完整的接口说明

---

## 六、使用场景

### 🎯 典型用户流程

**场景1: 新手用户首次使用**
```
1. 启动MongoDB、后端、前端服务
2. 访问 http://localhost:5173
3. 浏览器访问 http://localhost:5000/api/exercises/initialize
4. 输入用户名登录（如: zhangsan）
5. 返回首页，点击"开启训练"
6. 选择动作（如: 卧推）
7. 添加组数（60kg × 12次）
8. 完成该组，点击"完成"
9. 重复添加更多组数
10. 所有动作完成后，点击"完成训练"
11. 查看训练历史，分析进步情况
```

**场景2: 日常训练记录**
```
1. 打开应用（保持服务运行）
2. 首页显示"继续训练"或"新建训练"
3. 选择动作，记录组数
4. 实时查看训练时长
5. 完成训练，查看强度评分
6. 日历页面查看30天历史
```

**场景3: 历史数据分析**
```
1. 点击"训练日历"导航
2. 查看30天训练日历
3. 点击任意有训练的日期
4. 查看当日训练详情
5. 分析训练部位分布
6. 评估强度变化趋势
```

---

## 七、数据价值

### 📈 用户收益

**量化训练数据**:
- 记录每次训练的重量、次数、组数
- 自动计算训练强度和时长
- 可视化展示训练频率和部位分布

**追踪进步轨迹**:
- 对比不同时期的训练数据
- 分析力量增长趋势
- 优化训练计划和动作选择

**科学训练依据**:
- 基于数据调整训练强度
- 合理安排训练部位和休息
- 避免过度训练或训练不足

---

## 八、部署与运维

### 🚀 快速启动

**开发环境**:
```bash
# 终端1: MongoDB
mongod

# 终端2: 后端
cd backend
npm install
npm start

# 终端3: 前端
cd frontend
npm install
npm run dev

# 初始化动作库
curl -X POST http://localhost:5000/api/exercises/initialize
```

**访问地址**:
- 前端应用: http://localhost:5173
- 后端API: http://localhost:5000
- API文档: 见项目结构文档

---

## 九、版本迭代计划

### 🗺️ 功能更新记录

**v1.1.0 (2026-02-03)**:
- [x] ✅ 用户隔离与数据隔离 - 支持多用户独立使用
- [ ] 训练计划模板
- [ ] 数据导出功能（Excel/PDF）
- [ ] 图表统计（训练频率、强度趋势）

**v1.2.0 (中期)**:
- [ ] 动作图片/视频演示
- [ ] 1RM计算器
- [ ] 训练目标设置
- [ ] 社交分享功能

**v2.0.0 (长期)**:
- [ ] 移动端App（React Native）
- [ ] 云端数据同步
- [ ] AI训练建议
- [ ] 社区功能

---

## 十、产品优势

### 🏆 核心竞争力

**1. 简单易用**
- 3秒开始训练，无需复杂配置
- 直观的操作界面，零学习成本
- 实时反馈，操作即时生效

**2. 专业可靠**
- 内置24个专业健身动作
- 科学的训练强度算法
- 完整的数据持久化方案

**3. 数据驱动**
- 量化每次训练数据
- 可视化历史记录
- 支持数据导出和分析

**4. 开源免费**
- 代码完全开源
- 可自定义扩展
- 无广告，无内购

---

## 十一、技术文档索引

**用户文档**:
- [快速开始指南.md](快速开始指南.md) - 3步启动教程
- [项目结构文档.md](项目结构文档.md) - 技术架构说明

**API文档**:
- [项目结构文档.md](项目结构文档.md) - 完整API列表
- [frontend/src/services/api.js](frontend/src/services/api.js) - 前端API封装
- [backend/routes/](backend/routes/) - 后端路由定义

**数据库文档**:
- [backend/models/Workout.js](backend/models/Workout.js) - 训练记录模型
- [backend/models/Exercise.js](backend/models/Exercise.js) - 动作库模型

---

**产品状态**: ✅ 功能完整，可投入使用

**技术支持**: 开源项目，欢迎Issue和PR

**最后更新**: 2026-02-03
